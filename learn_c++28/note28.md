## `deque`：双端队列

### 用法

`deque`（双端队列）是一种支持在两端高效插入和删除元素的序列容器。与`vector`相比，`deque`支持在前端和后端均以常数时间进行插入和删除操作。

### 内部实现原理

`deque`通常由一系列固定大小的数组块组成，这些块通过一个中央映射数组进行管理。这种结构使得在两端扩展时不需要重新分配整个容器的内存，从而避免了`vector`在前端插入的高成本。

### 性能特性

- **随机访问**：支持常数时间的随机访问（`O(1)`）。
- **前后插入/删除**：在前端和后端插入和删除元素的操作都是常数时间（`O(1)`）。
- **中间插入/删除**：在中间位置插入或删除元素需要移动元素，时间复杂度为线性时间（`O(n)`）。

### 应用场景

- 需要在容器两端频繁插入和删除元素。
- 需要随机访问元素。
- 不需要频繁在中间位置插入和删除元素。

## 双端队列简介

**双端队列（deque）**是一种序列容器，允许在其两端高效地插入和删除元素。与`vector`不同，`deque`不仅支持在末尾添加或删除元素（如`vector`），还支持在头部进行同样的操作。此外，`deque`提供了随机访问能力，可以像`vector`一样通过索引访问元素。

### 主要特点

- **双端操作**：支持在头部和尾部高效的插入和删除操作。
- **随机访问**：可以像数组和`vector`一样通过索引访问元素。
- **动态大小**：可以根据需要增长和收缩，无需预先定义大小。

------

### 内存分配策略

`deque`内部并不使用一个单一的连续内存块，而是将元素分割成多个**固定大小的块**（也称为**缓冲区**或**页面**），并通过一个**中央映射数组**（通常称为**map**）来管理这些块。具体来说，`deque`的内部结构可以分为以下几个部分：

1. 中央映射数组（Map）

   ：

   - 一个指针数组，指向各个数据块。
   - `map`本身也是动态分配的，可以根据需要增长或收缩。
   - `map`允许`deque`在两端添加新的数据块，而无需移动现有的数据块。

2. 数据块（Blocks）

   ：

   - 每个数据块是一个固定大小的连续内存区域，用于存储元素。
   - 数据块的大小通常与编译器和平台相关，但在大多数实现中，数据块的大小在运行时是固定的（如512字节或更多，具体取决于元素类型的大小）。

3. 起始和结束指针

   ：

   - `deque`维护指向中央映射数组中第一个有效数据块的指针以及第一个无效数据块的指针。
   - 这些指针帮助`deque`快速地在两端添加或删除数据块。